# SCEssentials
Spigot плагин, предоставляющий базовый функционал, помогающий в администрировании сервера

Некоторые команды (такие как `/passive`) обнуляются после выхода из игры.

Некоторые команды умеют сохраняться после перезахода (на данный момент это только `/vanish`).
Однако для этого потребуется плагин [PlayerState](https://github.com/VadimkaG/SCPlayerState)

# Команды
* `/scereload` - Перезагружает конфигурацию плагина
* `/pinfo <Игрок>` - Информация об игроке
* `/fly <Игрок>` - Выключить/Включить полет игроку
* `/heal <Количество/Игрок> [Количество]` - Устанавливает здоровье у игрока
* `/feed [Игрок]` - Накормить игрока
* `/oi <Игрок> [ender/equipment]` - Открывает инвентарь игрока (эндер сундук и обмондирование открывается отдельно)
* `/sleepignore` - Включить/Выключить игнорирование требования кровати, чтобы скипнуть ночь
* `/suicide` - Самоубиться
* `/world <Подкоманда>` - Команда управления мирами (введите команду, чтобы получить справку по ней)
* `/lockbook` - Открыть/Закрыть книгу для записи. Позволит редактировать книгу, которая уже подписана
* `/freeze <Игрок>` - Заморозить игрока (он не сможет выполнять никакие действия, кроме чата)
* `/accept` - Принять какой-либо запрос (Смотри API запросов)
* `/specmode` - Включить/Выключить режим наблюдения
* `/tpp <Игрок>` - Телепорт к игроку
* `/tpb <Игрок>` - Телепорт к кровати игрока
* `/passive` - Переход в пассивный режим (В пассивном режиме вас не могут атаковать игроки. Но и вы не можете атаковать их)
* `/bunder` - Поставить блок под собой
* `/speed <Скорость/default> [walk/fly] <Игрок>` - Установить скорость передвижения
* `/vanish` - Включить режим скрытности. Режим скрытности скрывает вас визуально и в TAB.

# Привилегии
* `scessentials.*` - Все привилегии плагина (по умолчанию у операторов)
* `scessentials.reload` - Доступ к команде `/reload`
* `scessentials.suicide` - Доступ к команде `/suicide` (по умолчанию)
* `scessentials.combat` - Разрешает выход во время боя (система защиты от выхода во время пвп)
* `scessentials.feed` - Доступ к команде `/feed`
* `scessentials.feed.other` - Разрешает кормить других
* `scessentials.feed.*` - Доступ к выше перечисленным привилегиям feed
* `scessentials.fly` - Доступ к команде `/fly`
* `scessentials.fly.other` - Разрешает включать полет другим игрокам
* `scessentials.fly.*` - Доступ к выше перечисленным привилегиям fly
* `scessentials.heal` - Доступ к команде `/heal`
* `scessentials.heal.other` - Разрешает личить других игроков
* `scessentials.heal.*` - Доступ к выше перечисленным привилегиям heal
* `scessentials.openinventory` - Доступ к команде `/oi`
* `scessentials.pinfo` - Доступ к команде `/pinfo`
* `scessentials.sleepignore` - Доступ к команде `/sleepignore`
* `scessentials.freeze` - Доступ к команде `/freeze`
* `scessentials.spectator` - Доступ к команде `/specmode`
* `scessentials.teleport.toplayers` - Доступ к команде `/tpp`
* `scessentials.teleport.tobed` - Доступ к команде `/tpb`
* `scessentials.teleport.tobed.other` - Возможность телепортироваться на чужие кровати
* `scessentials.world.teleport` - Доступ к команде `/world tp`
* `scessentials.world.teleport.other` - Разрешить телепортировать игрока в другой мир
* `scessentials.teleport.*` - Доступ к любым телепортам плагина (в т.ч. по мирам), кроме `world.teleport.other`
* `scessentials.teleport.immunity` - Иммунитет телепортов к себе (только если включено в конфигурации)
* `scessentials.world.manage` - Доступ к загрузке/отгрузке и списку миров
* `scessentials.passivemode` - Доступ к команде `/passive`
* `scessentials.blockunderme` - Доступ к команде `/bunder`
* `scessentials.speed` - Доступ к команде `/speed`
* `scessentials.vanish` - Доступ к команде `/vanish` (если игрок не имеет преимущества, но вышел со включеном режимом, то при выходе он выключится)

# Упрощенная защита от DOS(Bot) атак
Плагин оснощен упрощенным алгоритмом от спама перезахода игроков.
Это можно отключить в конфигурации, если необходимо (потребуется перезапуск севера).

Алгоритм на раннем этапе (событие AsyncPlayerPreLoginEvent) анализирует как много игроков заходит на сервер.
Если одновременно на сервер заходит много игроков - плагин начинает отказывать входу, вежливо прося подождать.

При каждом заходе игрока на сервер - на ip игрока навешивается shadow ban на 15 секунд, при этом с сервера игрока не кикает.
Это необходимо для того, чтобы игрок не мог быстро перезаходить на сервер.

Алгоритм имеет 3 режима работы:
* *Стандартный режим.* Анализирует частоту захода игроков. Если между заходом двух игроков прошло менее секунды, то начинется счетчик игроков (если больше секунды, счетчик обнуляется). Когда счетчик достигает 40 человек - Включется медленный режим
* *Медленный режим.* При медленном режиме впускается лишь один человек в секунду. Всем остальным будет отклонен заход в игру.
* *Полная блокировка.* Если в секунду более 1000 перезаходов - включается режим полной блокировки (никого не впускает). Данный режим будет действовать до тех пор, пока "Очередь" не уменьшится хотябы до 125. Данный режим проще с точки зрения вычислений и необходим как последний рубеж, когда на сервер стучится большое количество запросов.

# Управление мирами
Данный плагин позволяет подгружать (в том числе создать новый) несколько миров, а также отгружать их или поставить миры на автозагрузку.
Также плагин предоставляет возможность создания полностью пустого мира (deprecated фнукция).

Команды можно узнать в справке, введя команду `/world`

# API
Плагин хранит все статусы игрока в его мета данных.
Манипулируя этими метаданными можно включать/выключать функции прямиком из програмного кода.

Смотри package `meta`
